<import src="talkinfo.skeleton.wxml"/>
<template is="skeleton" wx-if="{{loadModal}}" />

<view class="push" wx:for="{{postlist}}" wx:data-item="item" wx:key="key" touchmove="touchmove">
  <view class="user">
    <view>
      <image src="{{item.avatarurl}}" class="userinfoimg"></image>
    </view>
    <view class="userinfotext">
      <view class="nickname">{{item.nickname}}</view>
      <view class="userpushtime">{{item.pushtime}}</view>
    </view> 
  </view>
  <view class="userpush">
    <text class="userpushtext" user-select="true">{{item.info}}</text>
    <view class="userpushimg" wx:if="{{item.imgurl}}">
      <image class="itemimg" src="{{item.imgurl}}" data-id="{{item.imgurl}}" mode="aspectFill" bindtap="tapimg"></image>
    </view>
  </view>

  <view class="line"></view>

  <view class="cu-timeline" style="margin-bottom:180rpx">
    <view class="cu-time">最新</view>
    <view class="cu-item text-grey" wx:for="{{getcommentlist}}" wx:for-item="post" wx:key="unique" wx:if="{{post.postid == item._id}}">
      <view class="content bg-grey shadow-blur">
        <text>{{post.postuser}}:</text>
        <text user-select="true">{{post.commit}}</text>
      </view>
    </view>
    <view style="text-align:center;color:rgb(223, 222, 222)">还不赶紧说点什么！</view>
  </view>

  
  <view class="pushinfo" bindtap="inputcomment" wx:if="{{showinput}}">

    <view wx:if="{{showlikelist[index] == false}}" data-id="{{item._id}}" data-openid="{{item._openid}}" data-like="{{item.likecount}}" data-num="{{index}}" bindtap="likeminuus">
      <image class="likeimg" src="/images/liked.png"></image>
      <text class="likes">{{item.likecount}}</text>
    </view>

    <view wx:else data-id="{{item._id}}" data-openid="{{item._openid}}" data-like="{{item.likecount}}" data-num="{{index}}" bindtap="likeadd">
      <image class="likeimg" src="/images/like.png"></image>
      <text class="likes">{{item.likecount}}</text>
    </view>

    <view class="commentimg">
      <image class="commentimg" src="/images/comment.png"></image>
    </view>
    <view class="pushinput">
      <textarea wx:if="{{!isios}}" class="inputpost" adjust-position="true" placeholder="发表回复" bindinput="pushinput" value="{{inputclean}}" cursor-spacing="15" bindfocus="focuscomment" auto-height="true"/>
      <textarea wx:if="{{isios}}" class="inputpost" style="padding:0" adjust-position="true" placeholder="发表回复" bindinput="pushinput" value="{{inputclean}}" cursor-spacing="15" bindfocus="focuscomment" auto-height="true"/>
    </view>
    <text class="postsend" data-id="{{item._id}}" data-count="{{item.commentcount}}" type="default" size="mini" bindtap="uploadcomment">发表</text>
  </view>

  <!-- 打开上传信息页面悬浮按钮 -->
  <view wx:if="{{!isios}}" data-id="{{item._id}}" bindtap="share">
    <view class="pushbutton">
      <image class="pushbuttonimg" src="/images/pyq.png"></image>
    </view>
  </view>

</view>

<view class='cu-load load-modal' wx:if="{{loadModal}}">
  <image src='/images/logo.jpg' class='png' mode='aspectFit'></image>
  <view class='gray-text'>加载中...</view>
</view>

